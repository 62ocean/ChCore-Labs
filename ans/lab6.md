# 实验6 - 实验报告

## 思考题1

1. 在circle中，SDHost是一个SD卡的主机控制器，EMMC是一个集成了MMC和SD卡控制器的芯片。SD卡和EMMC都可以通过SDHost进行控制和访问。SDHost提供了一个标准的接口，使得SD卡和EMMC可以通过相同的方式进行访问和控制。

2. Chcore通过MMIO（Memory-Mapped I/O）的方式与SD卡进行交互。Chcore将SD卡的寄存器映射到内存空间中，然后通过读写内存的方式来访问SD卡的寄存器。Chcore发出的指令是通过IssueCommand函数来实现的。该函数会将指令写入SD卡的命令寄存器中，并等待SD卡的响应。SD卡的响应是通过中断的方式返回的，Chcore会在中断处理函数中读取SD卡的响应。

3. 首先，调用map_mmio函数将SD卡的内存映射区域映射到Chcore的内存区域。接下来，调用Initialize函数初始化SD卡。该函数设置SD卡的时钟和电压水平，并向卡发送初始化命令。最后，调用ipc_register_server函数将SD驱动注册为IPC服务器。

4. 在驱动代码的初始化中，设置时钟频率的意义是为了使SD卡和主机之间的通信同步。SD卡和主机之间的通信需要使用时钟信号进行同步，因此需要设置合适的时钟频率。TimeoutWait函数的作用是等待一段时间，以确保SD卡已经完成了相应的操作。在初始化过程中，需要等待SD卡的响应，因此需要调用TimeoutWait函数进行等待。
